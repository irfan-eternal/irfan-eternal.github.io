[{"categories":["Malware Analysis"],"content":"Unmapping PE files, fixing Alignment and Fixing coruupted/Missing PE Header","date":"2022-09-30","objectID":"/unmapping-pe-files-fixing-alignment-and-fixing-corrupted-or-missing-pe-header/","tags":null,"title":"Unmapping PE files, fixing Alignment and Fixing corrupted/Missing PE Header","uri":"/unmapping-pe-files-fixing-alignment-and-fixing-corrupted-or-missing-pe-header/"},{"categories":["Malware Analysis"],"content":" Hi all, Today i am writting this Post to help you from the common problems faced while unpacking malware They are Unmapping PE files Fixing Alignment and Fixing corrupted/Missing PE Header First we will be Discusiing how to Unmap PE file Unmapping PE files While Unpacking malware we dump the mapped binay into file.For proper anaylsis we need to convert this to an Unmapped Binary. We can make sure that the binary is mapped by looking at the raw address of first section. it will be always 1000. for unmapped binaries the first section starts at 400. The tools we will be using are PE-bear and HxD ","date":"2022-09-30","objectID":"/unmapping-pe-files-fixing-alignment-and-fixing-corrupted-or-missing-pe-header/:0:0","tags":null,"title":"Unmapping PE files, fixing Alignment and Fixing corrupted/Missing PE Header","uri":"/unmapping-pe-files-fixing-alignment-and-fixing-corrupted-or-missing-pe-header/"},{"categories":["Malware Analysis"],"content":"Steps Open the File in PE-bear go to the Section Hdrs tab Make the Raw address match the Virtual address of Sections Set the Raw size and Virtual size correct using this formula Raw size of Section n = VA of section n+1 - VA of section n Ex : Raw size of first Section(.text 22000) = Virtual Address of Section 2 (.rdata = 23000) - Virtual Address of Section 1 (.text = 1000) Follow this formula for all Other section except reloc Make the Virtual Size match the Raw size for all sections except reloc Make reloc size 0 Because reloc section only exist in disk . since we have dumped the pe from memory it won’t have reloc section Go to Optional Header tab and make sure the image base is same as the packed binary’s image Base This is the Final Unmapped PE. Save It Fixing Alignment and Fixing corrupted/Missing PE Header ","date":"2022-09-30","objectID":"/unmapping-pe-files-fixing-alignment-and-fixing-corrupted-or-missing-pe-header/:1:0","tags":null,"title":"Unmapping PE files, fixing Alignment and Fixing corrupted/Missing PE Header","uri":"/unmapping-pe-files-fixing-alignment-and-fixing-corrupted-or-missing-pe-header/"},{"categories":["Malware Analysis"],"content":"Steps first add the correct pe header : look for 4c 01 (cpu architecture 386 in optional header ) open the corrupted file and a known good file and copy and paste till 4c01 (use HxD) check and fix section allignment : move to raw address of section 1 . is the byte zeroed out correctly till the start if not add 00 bytes till the start example of adding 00 using hxd ","date":"2022-09-30","objectID":"/unmapping-pe-files-fixing-alignment-and-fixing-corrupted-or-missing-pe-header/:2:0","tags":null,"title":"Unmapping PE files, fixing Alignment and Fixing corrupted/Missing PE Header","uri":"/unmapping-pe-files-fixing-alignment-and-fixing-corrupted-or-missing-pe-header/"},{"categories":null,"content":"About Me","date":"2022-09-29","objectID":"/about/","tags":null,"title":"About Me","uri":"/about/"},{"categories":null,"content":" Hi all. I am irfan_eternal. Malware analyst interested in Reverse Engineering. I have been working in the Blue Side for 2 years. I love analysing malwares because It is more of a puzzle. where we are trying to identify what it does by defeating anti-analysis techniques ","date":"2022-09-29","objectID":"/about/:0:0","tags":null,"title":"About Me","uri":"/about/"},{"categories":null,"content":"Skills Static and Dynamic Malware Analysis Analysis of Web Attacks Reverse Engineering Automation YARA Rule Creation to detect Malware ","date":"2022-09-29","objectID":"/about/:0:1","tags":null,"title":"About Me","uri":"/about/"}]